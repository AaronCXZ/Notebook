## 10.1 分解条件表达式（Decompose Conditional）

1. 名称

2. 一个简单的速写

```javascript
if (!aDate.isBefore(plan.summerStart) && !aData.isAfter(plan.summerEnd))
    charge = quantity * plan.summerRate;
else
    charge = quantity * plan.regularRate + plan.regularServiceCharge;
```

重构为：

```javascript
if (summer())
    charge = summerCharge();
else
    charge = regularCharge();
```

2. 动机

程序之中，复杂的条件逻辑是最常导致复杂度上升的地点之一。我们可以将它拆分为多个独立的函数，根据每个小块代码的用途，为分解而得的新函数命名，可以突出条件逻辑，更清楚的表明每个分支的作用。

4. 做法

- 对条件判断和每个条件分支分别运用提炼函数手法

5. 范例

```javascript
if (!aDate.isBefore(plan.summerStart) && !aData.isAfter(plan.summerEnd))
    charge = quantity * plan.summerRate;
else
    charge = quantity * plan.regularRate + plan.regularServiceCharge;
```

先吧判断条件提炼到一个独立的函数中

```javascript
if (summer())
    charge = quantity * plan.summerRate;
else
    charge = quantity * plan.regularRate + plan.regularServiceCharge;
function summer(){
    return !aDate.isBefore(plan.summerStart) && !aData.isAfter(plan.summerEnd)
}
```

然后提炼条件判断为真的分支

```javascript
if (summer())
    charge = summerCharge()
else
    charge = quantity * plan.regularRate + plan.regularServiceCharge;
function summer(){
    return !aDate.isBefore(plan.summerStart) && !aData.isAfter(plan.summerEnd);
}
function summerCharge(){
    return quantity * plan.summerRate;
}
```

最后提炼条件判断为假的分支

```javascript
if (summer())
    charge = summerCharge();
else
    charge = regularCharge();
function summer(){
    return !aDate.isBefore(plan.summerStart) && !aData.isAfter(plan.summerEnd);
}
function summerCharge(){
    return quantity * plan.summerRate;
}
function regularCharge(){
    return quantity * plan.regularRate + plan.regularServiceCharge;
}
```

提炼完成之后，使用三元运算符重新安排条件语句

```javascript
charge = summer() ? summerCharge() : regularCharge();s
function summer(){
    return !aDate.isBefore(plan.summerStart) && !aData.isAfter(plan.summerEnd);
}
function summerCharge(){
    return quantity * plan.summerRate;
}
function regularCharge(){
    return quantity * plan.regularRate + plan.regularServiceCharge;
}
```





























